---
layout: base.njk
title: Classifiche
---

<div class="page-header">
    <h1>Classifiche</h1>
</div>

<section class="section">
    <div class="container">
        <div class="classifiche-grid">
            {%- for classifica in collections.classifiche -%}
            <div class="classifica-accordion" id="accordion-{{ loop.index }}">

                <!-- Trigger accordion -->
                <button class="accordion-trigger" onclick="toggleAccordion('accordion-{{ loop.index }}')" aria-expanded="false">
                    <div class="accordion-trigger-left">
                        <span class="accordion-serie">{{ classifica.data.serie }} {{ classifica.data.year }}</span>
                        {%- if classifica.data.updated -%}
                        <span class="accordion-meta">Aggiornata al {{ classifica.data.updated | shortDate }}</span>
                        {%- endif -%}
                    </div>
                    <span class="accordion-arrow" aria-hidden="true">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </span>
                </button>

                <!-- Podio (top 3 sempre visibile) -->
                {%- if classifica.data.teams.length > 0 -%}
                <div class="podio-preview">
                    {%- for team in classifica.data.teams | limit(3) -%}
                    <div class="podio-row">
                        <span class="podio-pos p{{ loop.index }}">{{ loop.index }}</span>
                        <span class="podio-name">{{ team.name }}</span>
                        <span class="podio-pts">{{ team.points }} pt</span>
                    </div>
                    {%- endfor -%}
                </div>
                {%- endif -%}

                <!-- Classifica completa (accordion) -->
                <div class="accordion-body">
                    {%- if classifica.data.teams.length > 0 -%}
                    <table class="classifica-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Squadra</th>
                                <th>Pt</th>
                                <th>V</th>
                                <th>P</th>
                                <th>S</th>
                            </tr>
                        </thead>
                        <tbody>
                            {%- for team in classifica.data.teams -%}
                            <tr>
                                <td class="td-pos {% if team.position == 1 %}p1{% elif team.position == 2 %}p2{% elif team.position == 3 %}p3{% endif %}">
                                    {{ team.position }}
                                </td>
                                <td class="td-team">{{ team.name }}</td>
                                <td class="td-pts">{{ team.points }}</td>
                                <td class="td-num">{{ team.wins }}</td>
                                <td class="td-num">{{ team.draws }}</td>
                                <td class="td-num">{{ team.losses }}</td>
                            </tr>
                            {%- endfor -%}
                        </tbody>
                    </table>
                    {%- else -%}
                    <div style="padding:2rem;text-align:center;color:var(--gray-400);font-family:var(--font-condensed);">
                        Nessuna squadra inserita.
                    </div>
                    {%- endif -%}
                </div>

            </div>
            {%- else -%}
            <div class="empty-state">
                <p>Nessuna classifica ancora. Aggiungile dal pannello admin!</p>
            </div>
            {%- endfor -%}
        </div>
    </div>
</section>

<script>
    function toggleAccordion(id) {
        const accordion = document.getElementById(id);
        const isOpen = accordion.classList.contains('open');
        const trigger = accordion.querySelector('.accordion-trigger');

        // Chiudi tutti
        document.querySelectorAll('.classifica-accordion.open').forEach(el => {
            el.classList.remove('open');
            el.querySelector('.accordion-trigger').setAttribute('aria-expanded', 'false');
        });

        // Apri quello cliccato (se era chiuso)
        if (!isOpen) {
            accordion.classList.add('open');
            trigger.setAttribute('aria-expanded', 'true');
        }
    }
</script>

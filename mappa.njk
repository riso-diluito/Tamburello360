---
layout: base.njk
title: Mappa delle Squadre
---

<div class="page-header">
    <h1>Mappa</h1>
    <p>Le squadre di tamburello sulla mappa d'Italia</p>
</div>

<section class="section">
    <div class="container">
        <div class="mappa-container">
            <div id="map"></div>
        </div>

        {%- if collections.squadre.length > 0 -%}
        <div style="margin-top:2rem;">
            <div style="display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;">
                <span style="display:flex;align-items:center;gap:0.4rem;font-family:var(--font-condensed);font-size:0.85rem;font-weight:600;color:var(--gray-600);">
                    <span style="background:#d62828;color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:800;">A</span> Serie A
                </span>
                <span style="display:flex;align-items:center;gap:0.4rem;font-family:var(--font-condensed);font-size:0.85rem;font-weight:600;color:var(--gray-600);">
                    <span style="background:#f77f00;color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:800;">B</span> Serie B
                </span>
                <span style="display:flex;align-items:center;gap:0.4rem;font-family:var(--font-condensed);font-size:0.85rem;font-weight:600;color:var(--gray-600);">
                    <span style="background:#003049;color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:800;">C</span> Serie C
                </span>
                <span style="display:flex;align-items:center;gap:0.4rem;font-family:var(--font-condensed);font-size:0.85rem;font-weight:600;color:var(--gray-600);">
                    <span style="background:#6c757d;color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:800;">D</span> Serie D
                </span>
            </div>
        </div>
        {%- endif -%}
    </div>
</section>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map').setView([45.4, 11.0], 7);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© <a href="https://openstreetmap.org">OpenStreetMap</a>',
        maxZoom: 18
    }).addTo(map);

    function makeIcon(letter, color) {
        return L.divIcon({
            className: '',
            html: `<div style="background:${color};color:white;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-family:'Barlow Condensed',sans-serif;font-size:14px;border:3px solid white;box-shadow:0 3px 12px rgba(0,0,0,0.35);">${letter}</div>`,
            iconSize: [36, 36],
            iconAnchor: [18, 18]
        });
    }

    const icons = {
        'Serie A': makeIcon('A', '#d62828'),
        'Serie B': makeIcon('B', '#f77f00'),
        'Serie C': makeIcon('C', '#003049'),
        'Serie D': makeIcon('D', '#6c757d'),
    };

    const squadre = [
        {%- for squadra in collections.squadre -%}
        {
            nome: "{{ squadra.data.name }}",
            citta: "{{ squadra.data.city }}",
            lat: {{ squadra.data.lat }},
            lng: {{ squadra.data.lng }},
            serie: "{{ squadra.data.serie }}",
            {%- if squadra.data.description %}description: "{{ squadra.data.description }}",{%- endif %}
            {%- if squadra.data.website %}website: "{{ squadra.data.website }}"{% endif %}
        }{% if not loop.last %},{% endif %}
        {%- endfor -%}
    ];

    squadre.forEach(s => {
        const icon = icons[s.serie] || makeIcon('?', '#6c757d');
        const marker = L.marker([s.lat, s.lng], { icon }).addTo(map);

        let popup = `<div style="font-family:'Barlow',sans-serif;min-width:180px;">
            <strong style="font-family:'Barlow Condensed',sans-serif;font-size:1.1rem;color:#003049;">${s.nome}</strong>
            <div style="margin-top:0.4rem;font-size:0.85rem;color:#666;">
                üìç ${s.citta}<br>
                üèÜ ${s.serie}
            </div>`;
        if (s.description) popup += `<p style="margin-top:0.5rem;font-size:0.82rem;color:#888;">${s.description}</p>`;
        if (s.website) popup += `<a href="${s.website}" target="_blank" style="display:inline-block;margin-top:0.5rem;color:#f77f00;font-weight:700;font-size:0.85rem;">Sito web ‚Üí</a>`;
        popup += `</div>`;

        marker.bindPopup(popup);
    });
</script>
